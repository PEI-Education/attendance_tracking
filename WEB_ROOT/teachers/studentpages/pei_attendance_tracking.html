<!--
TemplateName:Teacher Backpack
-->
<!DOCTYPE html>
<html>
<head>
    <meta name="Author" content="Luke Walker, PEI Dept of Education">
    <meta name="Version" content="0.9">
	<title>~[text:psx.htmlc.teachers.studentpages.pei.attendance_concerns_checklist]</title>
	<link rel="stylesheet" type="text/css" href="/admin/pei_reports/css/foundation-icons.css" />
<!-- required scripts -->
	~[wc:commonscripts] 
<!-- Required style sheets: screen.css, and print.css -->
	<script src="/scripts/psQuery/psQuery.js"></script>
	<link href="/images/css/screen.css" rel="stylesheet" media="screen">
	<link href="/images/css/print.css" rel="stylesheet" media="print">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@shoelace-style/shoelace@2.0.0/dist/themes/light.css" />
    <script type="module" src="https://cdn.jsdelivr.net/npm/@shoelace-style/shoelace@2.0.0/dist/shoelace.js"></script>
    <link href="/images/css/pei_att_track.css" rel="stylesheet">
    <script type="text/javascript">
    	function formHandler(form){
    	    var URL = document.navigation.page.options[document.navigation.page.selectedIndex].value;
    	    window.location.href = URL;
    	}

    function printDiv() {
        var popupWin = window.open('', '_blank', 'width=1000,height=600');
    
        popupWin.document.write('<html><head>'+
                                '<link rel="stylesheet" type="text/css" href="/admin/pei_reports/css/foundation-icons.css" />'+
                                '<link href="/images/css/print.css" rel="stylesheet" media="print">'+
                                '<link href="/images/css/pei_att_track.css" rel="stylesheet">'+
                                '<link href="/images/css/pei_att_track_print.css" rel="stylesheet">'+
                                '</head><body>' + document.querySelector('#printarea').innerHTML + '</html>');
        popupWin.print();  
    }
    </script>
</head>
<body>

~[wc:teachers_header_fr_css]

 <form name="navigation"><span class="account-photo">~[studenttitlephoto]</span>
 <h1>~[text:psx.htmlc.teachers.studentpages.pei.attendance_concerns_checklist]<span class="nav-teacher"><select name="page" size=1 onChange="javascript:formHandler()"><option value="">Select Screens</option><option value="">--------------------</option>~[x:teacherpages]</select></span>~[studentalert]</h1>
<p>~(studentname) &nbsp; ~(grade_level) &nbsp; ~(student_number) &nbsp; &nbsp; ~(track) &nbsp; &nbsp; ~(studschoolabbr) &nbsp; &nbsp; ~[enrollmentstatus]</p></form>

<div data-require-path="peiAttTrack/peiAttTrackTeach" data-module-name="attTrackMod"> 
    <div class="box-round" ng-controller="attTrackCtrl" ng-cloak>
        <input type="hidden" id="staffName" value="~[x:username;firstlast]" />
        <input type="hidden" id="studentsdcid" value="~(studentrn)" />
        <input type="hidden" id="dateToday" value="~[date]" />
        <input type="hidden" id="studentName" value="~(first_name) ~(last_name)" />
        <input type="hidden" id="gradeInYear" value="~[tlist_sql;select e.grade_level from ps_schoolenrollment e where e.studentid = ~(curstudid) and e.yearid = ~(curyearid) order by 1;nonemessage=-9]~(1)[/tlist_sql]" />
        <input type="hidden" id="termid" value="~[tlist_sql;select id from terms where schoolid = ~(curschoolid) and yearid = ~(curyearid) and lastday >= to_date('~[date]','mm/dd/yyyy') and firstday <= to_date('~[date]','mm/dd/yyyy') and isYearRec = ~[if.~(grade_level)>9]0[else]1[/if];nonemessage='No results']~(term;json)[/tlist_sql]" />
        <div>
            <h2>Checklist for ~[tlist_sql;select name from terms where schoolid = ~(curschoolid) and yearid = ~(curyearid) and lastday >= to_date('~[date]','mm/dd/yyyy') and firstday <= to_date('~[date]','mm/dd/yyyy') and isYearRec = ~[if.~(grade_level)>9]0[else]1[/if];nonemessage='No results']~(term;json)[/tlist_sql]<span class="right boldtext">Grade level this term: {{gradeInYear}}&nbsp; &nbsp; <button class="btn btn-primary" onclick="printDiv()"><i class="fi-print"></i> Print View</button></span></h2>
            <div class="feedback-info no-print">
                <ul>
                    <li>This checklist must be completed sequentially. Most steps must have a date later than the step before. In the case of written notifications, 5 school days have to pass between a notification being sent and the next concern being flagged. The one exception is the first parent call for high school students, which can come before or after student notification.</li>
                    <li>Each section of this checklist has a separate save button (with the <i class="fi-checkbox"></i> icon) that submits the data for that section <strong>only</strong>.</li>
                    <li>In the event you need to clear data from a section, you must press the save button to confirm your change before editing any earlier sections.</li>
                    <li>A red border around a field indicates that you must fill in the field before saving and proceeding to the next step.</li>
<<<<<<< HEAD
                    <li>Office staff will see your requests for written notifications in their attendance dashboard. ~[if.prefschool.attendancetracking=]Your school administrators have not set up email notifications at this time.[else]A notification email will also be sent to: ~[displayprefschool:attendancetracking].[/if]</li>
                    <li>For a printable version of this checklist, click the <i class="fi-print"></i> <strong>Print View</strong> button above. A popup wil open with a version ovf this checklist that is formatted to fit either 8.5" x 11" or 8.5" 14" paper.</li>
=======
                    <li>Office staff will see your requests for written notifications in their attendance dashboard. If your school has a designated contact, you can use the <i class="fi-mail"></i> icon to create an email reminder.</li>
                    <li>For a printable version of this checklist, click the <i class="fi-print"></i> <strong>Print View</strong> button above. A popup wil open with a version of this checklist that is formatted to fit either 8.5" x 11" or 8.5" 14" paper.</li>
>>>>>>> 8ff56b3 (Email notification + homepage alert)
                </ul>
            </div>
            <fieldset ng-if="gradeInYear > 9">
                <legend>Student Contact</legend>
                <form name="forms.stu" id="stuForm" ng-submit="save($event,'student')" novalidate class="validatedForm noSubmitLoading" data-pss-validation-form data-dirty-state-check="true">
                    <table class="checklistTable">
                        <colgroup>
                            <col style="width:35%;" />
                            <col style="width:38%;" />
                            <col style="width:18%;" />
                            <col style="width:9%;" />
                        </colgroup>
                        <tbody>
                            <tr>
                                <td class="grid-item stretchCell">
                                    <label class="form-control" for="student_notification">
                                    <input type="checkbox" ng-model="record.student.student_notification" ng-click="toggle($event, 'student', 'student_notification')" name="student_notification" id="student_notification" ng-true-value="1" ng-false-value="0" ng-disabled="record.calls.parent_call_2>0"> Discussion of concern
                                    </label>
                                </td>
                                <td class="grid-item">
                                    <label for="student_notification_staff">Contacted by</label> 
                                    <input size="40" id="student_notification_staff" name="staff" length="40" ng-model="record.student.student_notification_staff" ng-disabled="record.student.student_notification==0" ng-required="record.student.student_notification==1" />
                                </td>
                                <td class="grid-item"> 
                                    <label for="student_notification_date">Date</label> 
<<<<<<< HEAD
                                    <input id="student_notification_date" name="date" ng-model="record.student.student_notification_date" type="text" pss-date-widget data-minDate="~[x:termbegdate]" ng-disabled="record.student.student_notification==0" ng-required="record.student.student_notification==1" />
=======
                                    <input id="student_notification_date" name="date" ng-model="record.student.student_notification_date" type="text" pss-date-widget data-minDate="~[x:termbegdate]" ng-disabled="record.student.student_notification==0 || record.calls.parent_call_1>0" ng-required="record.student.student_notification==1" />
>>>>>>> 8ff56b3 (Email notification + homepage alert)
                                </td>
                                <td class="grid-item center">
                                    <div id="student_save" ng-if="student_save=='saving'" data-pss-wait-spinner="small"></div>
                                    <button type="submit" id="student_save" ng-if="student_save=='unsaved' || student_save=='saved' || !student_save" ng-disabled="forms.stu.$invalid || forms.stu.$pristine"><i class="fi-checkbox icon"></i></button>
                                    <div id="saved" class="saved" ng-if="student_save=='saved' && !forms.stu.$dirty">Saved</div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </form>
            </fieldset>
             <fieldset>
                <legend>
                    <span class="qcicon">Initial Concern and Guardian Contact&nbsp;</span> 
                    <a class='dialogM' title='Quick Contacts' href="/teachers/alerts/pscb_contacts_alert_pt.html?frn=~(studentfrn)" style="visibility: visible;">
                      <img src="/images/iconContacts2.png" height="24" width="24" border="2">
                    </a>
                </legend>
                <form name="forms.calls" id="callsForm"  ng-submit="save($event,'calls')" novalidate class="validatedForm noSubmitLoading" data-pss-validation-form data-dirty-state-check="true">
                    <table class="checklistTable">
                        <colgroup>
                            <col style="width:35%;" />
                            <col style="width:38%;" />
                            <col style="width:18%;" />
                            <col style="width:9%;" />
                        </colgroup>
                        <tbody>
                            <tr>
                                <td class="grid-item stretchCell">
                                    <span class="label">Call #1 &nbsp;</span>
                                    <sl-radio-group label="" name="parent_call_1" value="{{record.calls.parent_call_1}}" >
                                        <sl-radio-button class="call-na" size="small" ng-click="recordCall($event, 'parent_call_1',0)" value="0" ng-disabled="record.calsvtetls.parent_call_2>0 || concerns.concern_2_req==1">Not attempted</sl-radio-button>
                                        <sl-radio-button class="call-nc" size="small" value="1" ng-click="recordCall($event, 'parent_call_1',1)" ng-disabled="record.calls.parent_call_2>0 || concerns.concern_2_req==1">No Contact</sl-radio-button>
                                        <sl-radio-button class="call-co" size="small" value="3" ng-click="recordCall($event, 'parent_call_1',3)" ng-disabled="record.calls.parent_call_2>0 || concerns.concern_2_req==1">Contact Made</sl-radio-button>
                                    </sl-radio-group>
                                </td>
                                <td class="grid-item">
                                    <label for="parent_call_1_staff">Contacted by</label> 
                                    <input size="40" id="parent_call_1_staff" name="staff" ng-model="record.calls.parent_call_1_staff" ng-disabled="record.calls.parent_call_1==0 || record.calls.parent_call_2>0 || concerns.concern_2_req==1" ng-required="record.calls.parent_call_1>0" />
                                </td>
                                <td class="grid-item">
                                    <label for="parent_call_1_date">Date</label> 
                                    <input id="parent_call_1_date" name="date" ng-model="record.calls.parent_call_1_date" type="text" pss-date-widget  data-minDate="{{ record.student.student_notification_date }}" ng-disabled="record.calls.parent_call_1==0 || record.calls.parent_call_2>0 || concerns.concern_2_req==1" ng-required="record.calls.parent_call_1>0" />
                                </td>
                                <td class="grid-item center" rowspan="4">
                                    <div id="calls_save" ng-if="calls_save=='saving'" data-pss-wait-spinner="small"></div>
                                    <button type="submit" ng-click="save($event, 'calls')" id="calls_save" ng-if="calls_save=='unsaved' || calls_save=='saved' || !calls_save"  ng-disabled="forms.calls.$invalid || forms.calls.$pristine || forms.stu.$dirty"><i class="fi-checkbox icon"></i></button>
                                    <div id="saved" class="saved" ng-if="calls_save=='saved' && !forms.calls.$dirty">Saved</div>
                                </td>
                            </tr>
                            <tr class="alternateRow">
                                <td class="grid-item stretchCell">
                                    <span class="label">Call #2 &nbsp;</span>
                                    <sl-radio-group label="" name="parent_call_2" value="{{record.calls.parent_call_2}}" >
                                        <sl-radio-button class="call-na" size="small" ng-click="recordCall($event, 'parent_call_2',0)" value="0" ng-disabled="record.calls.parent_call_1==0 || record.calls.parent_call_3>0 || concerns.concern_2_req==1">Not attempted</sl-radio-button>
                                        <sl-radio-button class="call-nc" size="small" value="1" ng-click="recordCall($event, 'parent_call_2',1)" ng-disabled="record.calls.parent_call_1==0 || record.calls.parent_call_3>0  || concerns.concern_2_req==1">No Contact</sl-radio-button>
                                        <sl-radio-button class="call-co" size="small" value="3" ng-click="recordCall($event, 'parent_call_2',3)" ng-disabled="record.calls.parent_call_1==0 || record.calls.parent_call_3>0  || concerns.concern_2_req==1">Contact Made</sl-radio-button>
                                    </sl-radio-group>
                                </td>
                                <td class="grid-item">
                                    <label for="parent_call_2_staff">Contacted by</label> 
                                    <input size="40" id="parent_call_2_staff" name="staff" ng-model="record.calls.parent_call_2_staff" ng-disabled="record.calls.parent_call_2==0 || record.calls.parent_call_3>0  || concerns.concern_2_req==1" ng-required="record.calls.parent_call_2>0" />
                                </td>
                                <td class="grid-item">
                                    <label for="parent_call_2_date">Date</label> 
                                    <input id="parent_call_2_date" name="date" ng-model="record.calls.parent_call_2_date" type="text" pss-date-widget data-minDate="{{ record.calls.parent_call_1_date }}" ng-disabled="record.calls.parent_call_2==0 || record.calls.parent_call_3>0  || concerns.concern_2_req==1" ng-required="record.calls.parent_call_2>0" />
                                </td>
                            </tr>
                            <tr>
                                <td class="grid-item stretchCell">
                                    <span class="label">Call #3 &nbsp;</span>
                                    <sl-radio-group label="" name="parent_call_3" value="{{record.calls.parent_call_3}}" >
                                        <sl-radio-button class="call-na" size="small" ng-click="recordCall($event, 'parent_call_3',0)" value="0" ng-disabled="record.calls.parent_call_2==0 || concerns.concern_2_req==1">Not attempted</sl-radio-button>    
                                        <sl-radio-button class="call-nc" size="small" value="1" ng-click="recordCall($event, 'parent_call_3',1)" ng-disabled="record.calls.parent_call_2==0 || concerns.concern_2_req==1">No Contact</sl-radio-button>
                                        <sl-radio-button class="call-co" size="small" value="3" ng-click="recordCall($event, 'parent_call_3',3)" ng-disabled="record.calls.parent_call_2==0 || concerns.concern_2_req==1">Contact Made</sl-radio-button>
                                    </sl-radio-group>
                                </td>
                                <td class="grid-item">
                                    <label for="parent_call_3_staff">Contacted by</label> 
                                    <input size="40" id="parent_call_3_staff" name="staff" ng-model="record.calls.parent_call_3_staff" ng-disabled="record.calls.parent_call_3==0 || concerns.concern_2_req>0" ng-required="record.calls.parent_call_3>0" />
                                </td>
                                <td class="grid-item">
                                    <label for="parent_call_3_date">Date</label> 
                                    <input id="parent_call_3_date" name="date" ng-model="record.calls.parent_call_3_date" type="text" pss-date-widget  data-minDate="{{ record.calls.parent_call_2_date }}" ng-disabled="record.calls.parent_call_3==0 || concerns.concern_2_req>0" ng-required="record.calls.parent_call_3>0" />
                                </td>
                            </tr>
                            <tr class="alternateRow">
                                <td colspan="3" class="grid-item">
                                    <label for="parent_call_notes" class="notes-label">Notes</label>
                                    <textarea class="notes" id="parent_call_notes" name="parent_call_notes" ng-model="record.calls.parent_call_notes" ng-disabled="record.calls.parent_call_1==0 || concerns.concern_2_req==1" placeholder="Note any relevant details regarding phone calls with guardians." maxlength="4000"></textarea>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </form>
            </fieldset>
            <!-- For email notifications -->
            <div id="emailHelper" style="display: none;">
                <input name="type" type="hidden" id="emailType" value="100">
                <input type="text" id="emailFrom" value="~[x:useremail]" size=75 >
                <input type="text" value="~[displaypref:attendancetracking-S~(curschoolid)]" id="emailTo" size=75 >
                <input type="text" id="emailSubject" value="Attendance Letter Request for ~(first_name) ~(last_name)" size=35>
                <input id="emailBody" rows=12 cols=100 value="~[x:username;firstlast] has requested that an attendance letter be sent to the parents/guardians of ~(first_name) ~(last_name). Student Number: ~(student_number). Homeroom: ~(home_room).  &NewLine;&NewLine; This email was automatically generated when a teacher updated the Attendance Concern Checklist in PowerSchool. Contact powerschoolhelp@cloud.edu.pe.ca if you received this email in error."/>
                <input type="text" id="emailDate" name="date" value="~[date]" >
                <input type="text" id="emailTime" name="time" value="~(f.currenttime)" >
            </div>
            <fieldset>
                <legend>Continued Concern & Written Notification</legend>
                <table class="checklistTable">
                    <colgroup>
                        <col style="width:35%;" />
                        <col style="width:38%;" />
                        <col style="width:18%;" />
                        <col style="width:9%;" />
                    </colgroup>  
                    <tbody ng-form name="forms.concern_2" id="concern_2Form" novalidate class="validatedForm noSubmitLoading" data-pss-validation-form data-dirty-state-check="true">
                        <tr>
                            <td colspan="4">
                                <h3 class="concern-head">Written Notification #1</h3>
                                <input type="hidden" id="concern_2" name="concern_2" ng-model="record.concern_2.concern_2" />
                            </td>
                        </tr>
                        <tr>
                            <td colspan="4">
                                <ng-messages for="forms.concern_2.notes.$error" ng-show="forms.concern_2.$invalid && forms.concern_2.notes.$touched" role="alert">
                                    <ng-message when="required" class="feedback-error">Notes are required when a continued concern is flagged. Click the clipboard icon above for more information on documentation requirements.</ng-message>
                                    <ng-message when="minlength" class="feedback-error">Notes must be at least 20 characters.</ng-message>
                                    <ng-message when="maxlength" class="feedback-error">Notes must be less than 4000 characters.</ng-message>
                                </ng-messages>
                            </td>
                        </tr>
                        <tr>
                            <td class="grid-item stretchCell">
                                <label class="form-control" for="concern_2_req">
                                <input type="checkbox" ng-model="concerns.concern_2_req" ng-click="handleConcern($event, 'concern_2','concern_2_req')" name="concern_2_req" id="concern_2_req" ng-disabled="countCalls() || concerns.concern_2_sent===true" value="1" /> <span>Flag concern to admin &nbsp;<a type="button" class="button-icon" href="mailto:~[displaypref:attendancetracking-S~(curschoolid)]?subject=Request for 1st Attendance Letter for ~(first_name) ~(last_name)&body=I am requesting that a first attendance letter be sent to the parents/guardians of ~(first_name) ~(last_name). Student Number: ~(student_number). Homeroom: ~(home_room)." target="_blank" rel="noopener noreferrer" title="Send email to office" ng-show="'~[displaypref:attendancetracking-S~(curschoolid)]'"><i class="fi-mail icon"></i></a></span> 
                                </label>
                            </td>
                            <td class="grid-item">
                                <label for="concern_2_req_staff">Contacted by</label> 
                                <input size="40" id="concern_2_req_staff" name="req_staff" length="40" ng-model="record.concern_2.concern_2_req_staff" ng-disabled="!concerns.concern_2_req || concerns.concern_2_sent===true" ng-required="concerns.concern_2_req" />
                            </td>
                            <td class="grid-item">
                                <label for="concern_2_req_date">Date</label> 
                                <input id="concern_2_req_date" name="req_date" ng-model="record.concern_2.concern_2_req_date" type="text" pss-date-widget  ng-disabled="!concerns.concern_2_req || concerns.concern_2_sent==1" ng-required="concerns.concern_2_req" data-minDate="{{ record.calls.parent_call_3_date }}"/>
                            </td>
                            <td class="save-notes" rowspan="3">
                                <div id="concern_2_save" ng-if="concern_2_save=='saving'" data-pss-wait-spinner="small"></div>
                                <button type="submit" ng-click="saveAndEmail($event,'concern_2')" id="concern_2_save" ng-if="concern_2_save=='unsaved' || concern_2_save=='saved' || !concern_2_save" ng-disabled="forms.concern_2.$invalid || forms.concern_2.$pristine || forms.calls.$dirty"><i class="fi-checkbox icon"></i></button>
                                <div id="saved" class="saved" ng-if="concern_2_save=='saved' && !forms.concern_2.$dirty">Saved</div>
                                <div id="emailed" class="emailed" ng-if="concern_2_emailed==1 && !forms.concern_2.$dirty">Email Sent</div>
                            </td>
                        </tr>
                        <tr>
                            <td class="grid-item stretchCell">
                                <label class="form-control" for="concern_2_sent">
                                <input type="checkbox" ng-model="concerns.concern_2_sent" name="concern_2_sent" id="concern_2_sent" ng-disabled="true" value="1" /> Notification sent
                                </label>
                            </td>
                            <td class="grid-item">
                                <label for="concern_2_sent_staff">Contacted by</label> 
                                <input size="40" id="concern_2_sent_staff" name="sent_staff" length="40" ng-model="record.concern_2.concern_2_sent_staff" ng-disabled="true" />
                            </td>
                            <td class="grid-item">
                                <label for="concern_2_sent_date">Date</label> 
                                <input id="concern_2_sent_date" name="sent_date" ng-model="record.concern_2.concern_2_sent_date" type="text" pss-date-widget ng-disabled="true" />
                            </td>
                        </tr>
                        <tr>
                            <td colspan="3" class="grid-item">
                                <label class="notes-label" for="concern_2_notes">Notes (required)</label>
                                <p class="help-text">Note any concerns, dates and outcome of any parent/guardian contact or meetings after first notification letter. Note any supports or interventions that have been advised or put in place at this time. For example, referral to school-based student services team, youth worker, school counsellor, student well-being team, etc.</p>                                  
                                <textarea class="notes" id="concern_2_notes" name="notes" ng-model="record.concern_2.concern_2_notes" ng-disabled="!concerns.concern_2_req || concerns.concern_3_req===true" ng-required="concerns.concern_2_req===true" ng-minlength="20" maxlength="4000"></textarea>
                            </td>
                        </tr>
                    </tbody>
                    <tbody ng-form name="forms.concern_3" id="concern_3Form" novalidate class="validatedForm noSubmitLoading" data-pss-validation-form data-dirty-state-check="true">
                        <tr class="alternateRow">
                            <td colspan="4">
                                <h3 class="concern-head">Written Notification #2</h3>
                                <input type="hidden" id="concern_3" name="concern_3" ng-model="record.concern_3.concern_3" />
                            </td>
                        </tr>
                        <tr class="alternateRow">
                            <td colspan="4">
                                <ng-messages for="forms.concern_3.notes.$error" ng-show="forms.concern_3.$invalid && forms.concern_3.notes.$touched" role="alert">
                                    <ng-message when="required" class="feedback-error">Notes are required when a continued concern is flagged. Click the clipboard icon above for more information on documentation requirements.</ng-message>
                                    <ng-message when="minlength" class="feedback-error">Notes must be at least 20 characters.</ng-message>
                                    <ng-message when="maxlength" class="feedback-error">Notes must be less than 4000 characters.</ng-message>
                                </ng-messages>
                            </td>
                        </tr>
                        <tr class="alternateRow">
                            <td class="grid-item stretchCell">
                                <label class="form-control" for="concern_3_req">
                                <input type="checkbox" ng-model="concerns.concern_3_req" ng-click="handleConcern($event, 'concern_3','concern_3_req')" name="concern_3_req" id="concern_3_req" ng-disabled="disableConcern('concern_2') || concerns.concern_3_sent===true" value="1" /> <span>Flag concern to admin &nbsp;<a type="button" class="button-icon" href="mailto:~[displaypref:attendancetracking-S~(curschoolid)]?subject=Request for 2nd Attendance Letter for ~(first_name) ~(last_name)&body=I am requesting that a second attendance letter be sent to the parents/guardians of ~(first_name) ~(last_name). Student Number: ~(student_number). Homeroom: ~(home_room)." target="_blank" rel="noopener noreferrer" title="Send email to office" ng-show="'~[displaypref:attendancetracking-S~(curschoolid)]'"><i class="fi-mail icon"></i></a></span> 
                                </label>
                            </td>
                            <td class="grid-item">
                                <label for="concern_3_req_staff">Contacted by</label> 
                                <input size="40" id="concern_3_req_staff" name="req_staff" length="40" ng-model="record.concern_3.concern_3_req_staff" ng-disabled="!concerns.concern_3_req || concerns.concern_3_sent===true" ng-required="concerns.concern_3_req" />
                            </td>
                            <td class="grid-item">
                                <label for="concern_3_req_date">Date</label> 
                                <input id="concern_3_req_date" name="req_date" ng-model="record.concern_3.concern_3_req_date" type="text" pss-date-widget data-minDate="{{ addFiveDays(record.concern_2.concern_2_sent_date) | date: 'MM/dd/yyyy' }}" ng-disabled="!concerns.concern_3_req || concerns.concern_3_sent===true" ng-required="concerns.concern_3_req" />
                            </td>
                            <td class="save-notes" rowspan="3">
                                <div id="concern_3_save" ng-if="concern_3_save=='saving'" data-pss-wait-spinner="small"></div>
                                <button type="submit" ng-click="saveAndEmail($event,'concern_3')" id="concern_3_save" ng-if="concern_3_save=='unsaved' || concern_3_save=='saved' || !concern_3_save"  ng-disabled="forms.concern_3.$invalid || forms.concern_3.$pristine"><i class="fi-checkbox icon"></i></button>
                                <div id="saved" class="saved" ng-if="concern_3_save=='saved' && !forms.concern_3.$dirty">Saved</div>
                                <div id="emailed" class="emailed" ng-if="concern_3_emailed==1 && !forms.concern_3.$dirty">Email Sent</div>
                            </td>
                        </tr>
                        <tr class="alternateRow">
                            <td class="grid-item stretchCell">
                                <label class="form-control" for="concern_3_sent">
                                <input type="checkbox" ng-model="concerns.concern_3_sent" ng-click="handleConcern($event, 'concern_3','concern_3_sent')" name="concern_3_sent" id="concern_3_sent" ng-disabled="true" value="1" /> Notification sent
                                </label>
                            </td>
                            <td class="grid-item">
                                <label for="concern_3_sent_staff">Contacted by</label> 
                                <input size="40" id="concern_3_sent_staff" name="sent_staff" length="40" ng-model="record.concern_3.concern_3_sent_staff" ng-disabled="true" ng-required="concerns.concern_3_sent" />
                            </td>
                            <td class="grid-item">
                                <label for="concern_3_sent_date">Date</label> 
                                <input id="concern_3_sent_date" name="sent_date" ng-model="record.concern_3.concern_3_sent_date" type="text" pss-date-widget data-minDate="{{ record.concern_3.concern_3_req_date }}" ng-disabled="true" ng-required="concerns.concern_3_sent===true" />
                            </td>
                        </tr>
                        <tr class="alternateRow">
                            <td colspan="3" class="grid-item">
                                <label class="notes-label" for="concern_3_notes">Notes (required)</label>
                                <p class="help-text">Note dates of parent/guardian contact and outcome of any discussions or meetings after second notification letter. Note any supports or interventions that have been advised or put in place at this time. For example, documented support plan, referral to youth worker, school counsellor, student well-being team, outside agencies etc.</p>                                
                                <textarea class="notes" id="concern_3_notes" name="notes" ng-model="record.concern_3.concern_3_notes" ng-disabled="!concerns.concern_3_req || concerns.concern_4_req===true" ng-required="concerns.concern_3_req===true" ng-minlength="20" maxlength="4000"></textarea>
                                
                            </td>
                        </tr>
                    </tbody>
                     <tbody ng-form name="forms.concern_4" id="concern_4Form" novalidate class="validatedForm noSubmitLoading" data-pss-validation-form data-dirty-state-check="true">
                        <tr>
                            <td colspan="4">
                                <h3 class="concern-head">Written Notification #3</h3>
                                <input type="hidden" id="concern_4" name="concern_4" ng-model="record.concern_4.concern_4" />
                            </td>
                        </tr>
                        <tr>
                            <td colspan="4">
                                <ng-messages for="forms.concern_4.notes.$error" ng-show="forms.concern_4.$invalid && forms.concern_4.notes.$touched" role="alert">
                                    <ng-message when="required" class="feedback-error">Notes are required when a continued concern is flagged. Click the clipboard icon above for more information on documentation requirements.</ng-message>
                                    <ng-message when="minlength" class="feedback-error">Notes must be at least 20 characters.</ng-message>
                                    <ng-message when="maxlength" class="feedback-error">Notes must be less than 4000 characters.</ng-message>
                                </ng-messages>
                            </td>
                        </tr>
                        <tr>
                            <td class="grid-item stretchCell">
                                <label class="form-control" for="concern_4_req">
                                <input type="checkbox" ng-model="concerns.concern_4_req" ng-click="handleConcern($event, 'concern_4','concern_4_req')" name="concern_4_req" id="concern_4_req" ng-disabled="disableConcern('concern_3') || concerns.concern_4_sent===true" value="1" /> <span>Flag concern to admin &nbsp;<a type="button" class="button-icon" href="mailto:~[displaypref:attendancetracking-S~(curschoolid)]?subject=Request for 3rd Attendance Letter for ~(first_name) ~(last_name)&body=I am requesting that a third attendance letter be sent to the parents/guardians of ~(first_name) ~(last_name). Student Number: ~(student_number). Homeroom: ~(home_room)." target="_blank" rel="noopener noreferrer" title="Send email to office" ng-show="'~[displaypref:attendancetracking-S~(curschoolid)]'"><i class="fi-mail icon"></i></a></span> 
                                </label>
                            </td>
                            <td class="grid-item">
                                <label for="concern_4_req_staff">Contacted by</label> 
                                <input size="40" id="concern_4_req_staff" name="req_staff" length="40" ng-model="record.concern_4.concern_4_req_staff" ng-disabled="!concerns.concern_4_req || concerns.concern_4_sent===true" ng-required="concerns.concern_4_req" />
                            </td>
                            <td class="grid-item">
                                <label for="concern_4_req_date">Date</label> 
                                <input id="concern_4_req_date" name="req_date" ng-model="record.concern_4.concern_4_req_date" type="text" pss-date-widget data-minDate="{{ addFiveDays(record.concern_3.concern_3_sent_date) | date: 'MM/dd/yyyy' }}" ng-disabled="!concerns.concern_4_req || concerns.concern_4_sent===true" ng-required="concerns.concern_4_req" />
                            </td>
                            <td class="save-notes" rowspan="3">
                                <div id="concern_4_save" ng-if="concern_4_save=='saving'" data-pss-wait-spinner="small"></div>
                                <button type="submit" ng-click="saveAndEmail($event,'concern_4')" id="concern_4_save" ng-if="concern_4_save=='unsaved' || concern_4_save=='saved' || !concern_4_save"  ng-disabled="forms.concern_4.$invalid || forms.concern_4.$pristine"><i class="fi-checkbox icon"></i></button>
                                <div id="saved" class="saved" ng-if="concern_4_save=='saved' && !forms.concern_4.$dirty">Saved</div>
                                <div id="emailed" class="emailed" ng-if="concern_4_emailed==1 && !forms.concern_4.$dirty">Email Sent</div>
                            </td>
                        </tr>
                        <tr>
                            <td class="grid-item stretchCell">
                                <label class="form-control" for="concern_4_sent">
                                <input type="checkbox" ng-model="concerns.concern_4_sent" ng-click="handleConcern($event, 'concern_4','concern_4_sent')" name="concern_4_sent" id="concern_4_sent" ng-disabled="true" value="1" /> Notification sent
                                </label>
                            </td>
                            <td class="grid-item">
                                <label for="concern_4_sent_staff">Contacted by</label> 
                                <input size="40" id="concern_4_sent_staff" name="sent_staff" length="40" ng-model="record.concern_4.concern_4_sent_staff" ng-disabled="true" ng-required="concerns.concern_4_sent" />
                            </td>
                            <td class="grid-item">
                                <label for="concern_4_sent_date">Date</label> 
                                <input id="concern_4_sent_date" name="sent_date" ng-model="record.concern_4.concern_4_sent_date" type="text" pss-date-widget data-minDate="{{ record.concern_4s.concern_4_req_date }}" ng-disabled="true" ng-required="concerns.concern_4_sent===true" />
                            </td>
                        </tr>
                        <tr>
                            <td colspan="3" class="grid-item">
                                <label class="notes-label" for="concern_4_notes">Notes (required)</label>
                                <p class="help-text">Note dates of parent/guardian contact and outcome of any discussions or meetings after third notification letter. Note any further supports or interventions that have been advised or put in place at this time. For example, documented support plan, referral to youth worker, school counsellor, student well-being team, outside agencies etc.</p>
                                <textarea class="notes" id="concern_4_notes" name="notes" ng-model="record.concern_4.concern_4_notes" ng-disabled="!concerns.concern_4_req || record.referral.referral===1" ng-required="concerns.concern_4_req===true" ng-minlength="20" maxlength="4000"></textarea>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </fieldset>
             <fieldset>
                <legend>Referral</legend>
                <form name="forms.ref" id="refForm" ng-submit="save($event,'referral')" novalidate class="validatedForm noSubmitLoading" data-pss-validation-form data-dirty-state-check="true">
                    <table class="checklistTable">
                        <colgroup>
                            <col style="width:35%;" />
                            <col style="width:38%;" />
                            <col style="width:18%;" />
                            <col style="width:9%;" />
                        </colgroup>
                        <tbody>
                            <tr>
                                <td class="grid-item stretchCell">
                                    <label class="form-control" for="referral">
                                    <input type="checkbox" ng-model="record.referral.referral" ng-click="toggle($event, 'referral', 'referral')" name="referral" id="referral" ng-true-value="1" ng-false-value="0" ng-disabled="true"> Notification to the Director
                                    </label>
                                    <!--
                                   <button id="referral_btn" class="stretch" ng-show="record.referral.referral==0" ng-click="handleReferral()" ng-disabled="disableReferral()">Notification to Director</button>
                                   <div class="successText stretch" ng-show="record.referral.referral>0"><i class="fi-check"></i> Concern flagged</div>
                                    <input type="hidden" id="referral" name="referral" ng-model="record.referral.referral" data-step="referral" />-->
                                    <input type="hidden" ng-model="record.referral.referral" name="referral" id="referral">
                                </td>
                                <td class="grid-item">
                                    <label for="referral_staff">Contacted by</label> 
                                    <input size="40" id="referral_staff" name="staff" length="40" ng-model="record.referral.referral_staff" ng-disabled="true" ng-required="record.referral.referral==1" />
                                </td>
                                <td class="grid-item">
                                    <label for="referral_date">Date</label> 
                                    <input id="referral_date" name="date" data-minDate="{{ record.concern_4.concern_4_sent_date }}" ng-model="record.referral.referral_date" type="text" pss-date-widget  ng-disabled="true" />
                                </td>
                                <td row-span="2" class="save-notes">
                                    <div id="referral_save" ng-if="referral_save=='saving'" data-pss-wait-spinner="small"></div>
                                    <button type="submit" id="referral_save" ng-if="referral_save=='unsaved' || referral_save=='saved' || !referral_save" ng-disabled="true"><i class="fi-checkbox icon"></i></button>
                                    <div id="saved" class="saved" ng-if="referral_save=='saved' && !forms.ref.$dirty">Saved</div>
                                </td>
                            </tr>
                             <tr>
                                <td colspan="3" class="grid-item">
                                  <label class="notes-label" for="referral_notes">Notes</label>
                                  <textarea class="notes" id="referral_notes" name="referral_notes" ng-model="record.referral.referral_notes"  maxlength="4000" ng-disabled="true"></textarea>
                                </td>
                              </tr>
                        </tbody>
                    </table>
                </form>
            </fieldset>
        </div>
<!-- Printable -->
        <div id="printarea" class="printable">
            <div class="no-print warning">Print this document by selecting Print (in the ellipses menu in the upper right) or pressing Ctrl + P. Close this window one you have completed printing. This instructional text will not print.</div>
            <h1>~(first_name) ~(last_name)</h1>
            <h2>Checklist for ~[tlist_sql;select name from terms where schoolid = ~(curschoolid) and yearid = ~(curyearid) and lastday >= to_date('~[date]','mm/dd/yyyy') and firstday <= to_date('~[date]','mm/dd/yyyy') and isYearRec = ~[if.~(grade_level)>9]0[else]1[/if];nonemessage="No results"]~(term;json)[/tlist_sq]<span class="right boldtext">Grade level this term: {{gradeInYear}}</span></h2>
            <fieldset ng-if="gradeInYear > 9">
                <legend>Student Contact</legend>
                <table class="checklistTable">
                    <colgroup>
                        <col style="width:38%;" />
                        <col style="width:41%;" />
                        <col style="width:21%;" />
                    </colgroup>
                    <tbody>
                        <tr>
                            <td class="grid-item stretchCell">
                                <span ng-if="record.student.student_notification==1"><i class="fi-check"></i></span><span ng-if="record.student.student_notification != 1"><i class="fi-x"></i></span> &nbsp; Discussion of concern
                            </td>
                            <td class="grid-item">
                                <strong>Contacted by:</strong> {{ record.student.student_notification_staff }}
                            </td>
                            <td class="grid-item">
                                <strong>Date:</strong> {{ record.student.student_notification_date }}
                            </td>
                        </tr>
                    </tbody>
                </table>
            </fieldset>
             <fieldset>
                <legend>Initial Concern and Guardian Contact</legend>
                <table class="checklistTable">
                    <colgroup>
                        <col style="width:38%;" />
                        <col style="width:41%;" />
                        <col style="width:21%;" />
                    </colgroup>
                    <tbody>
                        <tr>
                            <td class="grid-item stretchCell">
                                <strong>Call #1 &nbsp;</strong><span ng-if="record.calls.parent_call_1 === 0">Not attempted</span><span ng-if="record.calls.parent_call_1 === 1">No contact made</span><span ng-if="record.calls.parent_call_1 === 3">Contact made</span>
                            </td>
                            <td class="grid-item">
                                <strong>Contacted by</strong> {{record.calls.parent_call_1_staff }}
                            </td>
                            <td class="grid-item">
                                <strong>Date: </strong> {{ record.calls.parent_call_1_date }}
                            </td>
                        </tr>
                        <tr>
                            <td class="grid-item stretchCell">
                                <strong>Call #2 &nbsp;</strong><span ng-if="record.calls.parent_call_2 === 0">Not attempted</span><span ng-if="record.calls.parent_call_2 === 1">No contact made</span><span ng-if="record.calls.parent_call_2 === 3">Contact made</span>
                            </td>
                            <td class="grid-item">
                                <strong>Contacted by</strong> {{record.calls.parent_call_2_staff }}
                            </td>
                            <td class="grid-item">
                                <strong>Date: </strong> {{ record.calls.parent_call_2_date }}
                            </td>
                        </tr>
                        <tr>
                            <td class="grid-item stretchCell">
                                <strong>Call #3 &nbsp;</strong><span ng-if="record.calls.parent_call_3 === 0">Not attempted</span><span ng-if="record.calls.parent_call_3 === 1">No contact made</span><span ng-if="record.calls.parent_call_3 === 3">Contact made</span>
                            </td>
                            <td class="grid-item">
                                <strong>Contacted by</strong> {{record.calls.parent_call_3_staff }}
                            </td>
                            <td class="grid-item">
                                <strong>Date: </strong> {{ record.calls.parent_call_3_date }}
                            </td>
                        </tr>
                        <tr>
                            <td colspan="3" class="grid-item">
                                <p><strong>Notes:</strong> {{record.calls.parent_call_notes}}</p>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </fieldset>
            <fieldset>
                <legend>Continued Concern & Written Notification</legend>
                <table class="checklistTable">
                    <colgroup>
                        <col style="width:38%;" />
                        <col style="width:41%;" />
                        <col style="width:21%;" />
                    </colgroup>  
                    <tbody>
                        <tr>
                            <td colspan="4">
                                <h3 class="concern-head">Written Notification #1</h3>
                            </td>
                        </tr>
                        <tr>
                            <td class="grid-item stretchCell">
                                <span ng-if="concerns.concern_2_req==true"><i class="fi-check"></i></span><span ng-if="concerns.concern_2_req != true"><i class="fi-x"></i></span>&nbsp; <strong>Flag concern to admin</strong>
                            </td>
                            <td class="grid-item">
                                <strong>Contacted by:</strong> {{record.concern_2.concern_2_req_staff }}
                            </td>
                            <td class="grid-item">
                                <strong>Date:</strong> {{ record.concern_2.concern_2_req_date }}
                            </td>
                        </tr>
                        <tr>
                            <td class="grid-item stretchCell">
                                <span ng-if="concerns.concern_2_sent==true"><i class="fi-check"></i></span><span ng-if="concerns.concern_2_sent != true"><i class="fi-x"></i></span>&nbsp; <strong>Notification sent</strong>
                            </td>
                            <td class="grid-item">
                                <strong>Contacted by:</strong> {{record.concern_2.concern_2_sent_staff }}
                            </td>
                            <td class="grid-item">
                                <strong>Date:</strong> {{ record.concern_2.concern_2_sent_date }}
                            </td>
                        </tr>
                        <tr>
                            <td colspan="3" class="grid-item">
                                <p><strong>Notes:</strong> {{record.concern_2.concern_2_notes}}</p>
                                
                            </td>
                        </tr>
                    </tbody>
                    <tbody>
                        <tr>
                            <td colspan="4">
                                <h3 class="concern-head">Written Notification #2</h3>
                            </td>
                        </tr>
                        <tr>
                            <td class="grid-item stretchCell">
                                <span ng-if="concerns.concern_3_req==true"><i class="fi-check"></i></span><span ng-if="concerns.concern_3_req != true"><i class="fi-x"></i></span>&nbsp; <strong>Flag concern to admin</strong>
                            </td>
                            <td class="grid-item">
                                <strong>Contacted by:</strong> {{record.concern_3.concern_3_req_staff }}
                            </td>
                            <td class="grid-item">
                                <strong>Date:</strong> {{ record.concern_3.concern_3_req_date }}
                            </td>
                        </tr>
                        <tr>
                            <td class="grid-item stretchCell">
                                <span ng-if="concerns.concern_3_sent==true"><i class="fi-check"></i></span><span ng-if="concerns.concern_3_sent != true"><i class="fi-x"></i></span>&nbsp; <strong>Notification sent</strong>
                            </td>
                            <td class="grid-item">
                                <strong>Contacted by:</strong> {{record.concern_3.concern_3_sent_staff }}
                            </td>
                            <td class="grid-item">
                                <strong>Date:</strong> {{ record.concern_3.concern_3_sent_date }}
                            </td>
                        </tr>
                        <tr>
                            <td colspan="3" class="grid-item">
                                <p><strong>Notes:</strong> {{record.concern_3.concern_3_notes}}</p>
                                
                            </td>
                        </tr>
                    </tbody>
                    <tbody>
                        <tr>
                            <td colspan="4">
                                <h3 class="concern-head">Written Notification #3</h3>
                            </td>
                        </tr>
                        <tr>
                            <td class="grid-item stretchCell">
                                <span ng-if="concerns.concern_4_req==true"><i class="fi-check"></i></span><span ng-if="concerns.concern_4_req != true"><i class="fi-x"></i></span>&nbsp; <strong>Flag concern to admin</strong>
                            </td>
                            <td class="grid-item">
                                <strong>Contacted by:</strong> {{record.concern_4.concern_4_req_staff }}
                            </td>
                            <td class="grid-item">
                                <strong>Date:</strong> {{ record.concern_4.concern_4_req_date }}
                            </td>
                        </tr>
                        <tr>
                            <td class="grid-item stretchCell">
                                <span ng-if="concerns.concern_4_sent==true"><i class="fi-check"></i></span><span ng-if="concerns.concern_4_sent != true"><i class="fi-x"></i></span>&nbsp; <strong>Notification sent</strong>
                            </td>
                            <td class="grid-item">
                                <strong>Contacted by:</strong> {{record.concern_4.concern_4_sent_staff }}
                            </td>
                            <td class="grid-item">
                                <strong>Date:</strong> {{ record.concern_4.concern_4_sent_date }}
                            </td>
                        </tr>
                        <tr>
                            <td colspan="3" class="grid-item">
                                <p><strong>Notes:</strong> {{record.concern_4.concern_4_notes}}</p>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </fieldset>
             <fieldset>
                <legend>Referral</legend>
                <table class="checklistTable">
                    <colgroup>
                        <col style="width:38%;" />
                        <col style="width:41%;" />
                        <col style="width:21%;" />
                    </colgroup>
                    <tbody>
                        <tr>
                            <td class="grid-item stretchCell">
                                 <span ng-if="record.referral.referral==1"><i class="fi-check"></i></span><span ng-if="record.referral.referral != 1"><i class="fi-x"></i></span> &nbsp; Notification to the Director
                            </td>
                            <td class="grid-item">
                                <strong>Contacted by:</strong> {{ record.referral.referral_staff }}
                            </td>
                            <td class="grid-item">
                                <strong>Date:</strong> {{ record.referral.referral_date }}
                            </td>
                        </tr>
                        <tr>
                            <td colspan="3" class="grid-item">
                                <p><strong>Notes:</strong> {{record.referral.referral_notes}}</p>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </fieldset>
        </div>
<!-- end of content of bounding box -->
    </div>
</div>
<!-- end of content area -->
~[wc:teachers_footer_fr_css]
</body>
</html>